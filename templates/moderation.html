<!-- templates/moderation.html -->
<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Mod√©ration</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='style_homogene.css') }}">
</head>
<body>
  {% include 'header.html' %}
  <div class="publications-container">
    <h1>Signalements √† traiter</h1>

    {% for sig in signalements %}
    <a href="{{ url_for('afficher_une_publication', id=sig.id_publication) }}" style="text-decoration: none; color: inherit;"><div class="publication-card">
      <a href="{{ url_for('afficher_une_publication', id=sig.id_publication) }}" style="text-decoration: none; color: inherit;">
        <div class="publication-meta">
          <img src="{{ url_for('static', filename=sig.photo_de_profil) }}" alt="Photo de profil" class="profile-pic">
          <div>
            <h2 class="publication-title">{{ sig.p_titre }}</h2>
            <p>
              Post√© par <strong>{{ sig.auteur }}</strong> ‚Ä¢ {{ sig.date_publication.strftime('%d/%m/%Y %H:%M') }}
              {% if sig.statut == 'anonyme' %}
                <em>(anonyme)</em>
              {% endif %}
            </p>
          </div>
        </div>
        <div class="publication-text">{{ sig.texte|truncate(200) }}</div>
      </a>

      <div class="publication-footer">
        <div class="left-comments">
          {{ sig.nb_reponses }} Commentaire{{ 's' if sig.nb_reponses > 1 }}
        </div>
        <div class="right-reactions">
          {% if reactions[sig.id_publication] is defined %}
            {% if reactions[sig.id_publication]['LIKE'] is defined %}
              üëç {{ reactions[sig.id_publication]['LIKE'] }}
            {% endif %}
            {% if reactions[sig.id_publication]['LOVE'] is defined %}
              ‚ù§Ô∏è {{ reactions[sig.id_publication]['LOVE'] }}
            {% endif %}
            {% if reactions[sig.id_publication]['DISLIKE'] is defined %}
              üëé {{ reactions[sig.id_publication]['DISLIKE'] }}
            {% endif %}
            {% if reactions[sig.id_publication]['SAD'] is defined %}
              üò¢ {{ reactions[sig.id_publication]['SAD'] }}
            {% endif %}
            {% if reactions[sig.id_publication]['ANGRY'] is defined %}
              üò° {{ reactions[sig.id_publication]['ANGRY'] }}
            {% endif %}
          {% endif %}
        </div>
      </div>

      <div style="margin-top: 15px;">
        <p><strong>Signal√© par :</strong> 
            <a href="{{ url_for('profil_utilisateur', username=sig.username) }}" class="bouton-profil">
                {{ sig.username }}
            </a>             
        </p>
        <p><strong>Raison du signalement :</strong> {{ sig.raison }}</p>
        <form action="{{ url_for('approuver_signalement') }}" method="post" style="display:inline;">
          <input type="hidden" name="id_signalement" value="{{ sig.id_signalement }}">
          <button type="submit">‚úÖ Approuver</button>
        </form>
        <form action="{{ url_for('rejeter_signalement') }}" method="post" style="display:inline;">
          <input type="hidden" name="id_signalement" value="{{ sig.id_signalement }}">
          <button type="submit">‚ùå Rejeter</button>
        </form>
      </div>
    </div>
    {% endfor %}
  </div>
</body>
</html>