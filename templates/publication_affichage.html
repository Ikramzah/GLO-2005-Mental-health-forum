<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <title>{{ publication.p_titre }}</title>
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='style.css') }}"
    />
    <style>
      body {
        padding-top: 100px;
        background-color: #b8d0eb;
        font-family: Arial, sans-serif;
        margin: 0;
      }
      .container {
        max-width: 1000px;
        margin: 80px auto;
        background-color: rgba(255, 255, 255, 0.95);
        padding: 30px;
        border-radius: 10px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
      }
      .publication {
        margin-bottom: 40px;
      }
      .publication-header {
        display: flex;
        align-items: center;
        gap: 20px;
        margin-bottom: 15px;
      }
      .publication-header img {
        width: 70px;
        height: 70px;
        border-radius: 50%;
        object-fit: cover;
      }
      .publication-header .info {
        flex: 1;
      }
      .publication-header .info h1 {
        margin: 0;
        font-size: 1.8em;
        color: #6f2dbd;
      }
      .publication-header .info p {
        color: #666;
        font-size: 0.9em;
      }
      .publication .texte {
        font-size: 1.1em;
        color: #333;
        line-height: 1.6;
        margin-bottom: 15px;
      }
      .publication img.publication-img {
        max-width: 100%;
        max-height: 400px;
        display: block;
        margin-top: 15px;
        border-radius: 8px;
      }
      .actions {
        display: flex;
        gap: 10px;
        margin-top: 10px;
      }
      .btn {
        background-color: #a663cc;
        color: white;
        border: none;
        padding: 8px 14px;
        border-radius: 4px;
        cursor: pointer;
        font-size: 0.9em;
        text-decoration: none;
      }
      .btn:hover {
        background-color: #6f2dbd;
      }
      .comment-section h2 {
        color: #6f2dbd;
      }
      .comment {
        background-color: #f7f7f7;
        padding: 15px;
        margin-bottom: 15px;
        border-radius: 6px;
      }
      .comment .meta {
        font-size: 0.85em;
        color: #555;
        margin-bottom: 6px;
      }
      .add-comment {
        margin-top: 30px;
        background-color: #eaeaea;
        padding: 20px;
        border-radius: 8px;
      }
      .add-comment textarea {
        width: 100%;
        height: 100px;
        padding: 10px;
        font-size: 1em;
        border: 1px solid #ccc;
        border-radius: 4px;
      }
      .add-comment button {
        margin-top: 10px;
        background-color: #6f2dbd;
        color: white;
        padding: 10px 16px;
        border: none;
        border-radius: 4px;
        cursor: pointer;
      }
      .add-comment button:hover {
        background-color: #4e1d8b;
      }
    </style>
  </head>
  <body>
    {% include 'header.html' %}

    <div class="container">
      <div class="publication">
        <div class="publication-header">
          <img src="{{ url_for('static', filename=publication.photo_profil_path) }}" alt="Photo de profil" />

          <div class="info">
            <h1>{{ publication.p_titre }}</h1>
            <p>
              Post√© par {% if publication.statut == 'anonyme' %}
              <em>Utilisateur anonyme</em>
              {% else %} {{ publication.prenom }} {{ publication.nom }} {% endif
              %} ‚Ä¢ {{ publication.date.strftime('%d/%m/%Y %H:%M') }}
            </p>
          </div>
        </div>

        <div class="texte">{{ publication.texte }}</div>

        {% if publication.images %}
          <img src="{{ url_for('static', filename=publication.images) }}" class="publication-img" alt="Image de la publication" />
        {% endif %}

        <div class="actions">
          {% if publication.username == user.username %}
          <a
            href="{{ url_for('modifier_publication', id=publication.id_publication) }}"
            class="btn"
            >‚úèÔ∏è Modifier</a
          >
          {% endif %}
          <a
            href="{{ url_for('signaler_publication', id=publication.id_publication) }}"
            class="btn"
            onclick="return confirm('Signaler cette publication ?');"
            >üö© Signaler</a
          >
        </div>
      </div>

      <div class="comment-section">
        <h2>Commentaires ({{ commentaires|length }})</h2>
        {% for com in commentaires %}
        <div class="comment">
          <div class="meta">
            {% if com.niveau_anonymat == 'anonyme' %} Utilisateur anonyme {%
            else %} {{ com.prenom }} {{ com.nom }} {% endif %} ‚Ä¢ {{
            com.date_et_heure.strftime('%d/%m/%Y %H:%M') }}
          </div>
          <div class="texte">{{ com.texte }}</div>
        </div>
        {% endfor %}
      </div>

      <div class="add-comment">
        <form
          method="POST"
          action="{{ url_for('ajouter_commentaire', id=publication.id_publication) }}"
        >
          <label for="texte">Ajouter un commentaire :</label>
          <textarea name="texte" id="texte" required></textarea>
          <button type="submit">Publier</button>
        </form>
      </div>
    </div>
  </body>
</html>
