<!DOCTYPE html>
<html lang="fr">
  <head>
    <!-- Encodage des caractÃ¨res -->
    <meta charset="UTF-8" />
    <title>Mes publications</title>

    <!-- Feuille de style globale -->
    <link rel="stylesheet" href="{{ url_for('static', filename='style_homogene.css') }}" />
  </head>

  <body>
    <!-- Inclusion de lâ€™en-tÃªte (barre de navigation) -->
    {% include 'header.html' %}

    <!-- Conteneur principal -->
    <div class="container publications-container">
      <h1 class="page-title">ğŸ“ Mes Publications</h1>

      <!-- Si l'utilisateur a des publications -->
      {% if publications %}
        {% for pub in publications %}
        <!-- Lien vers la page de la publication individuelle -->
        <a href="{{ url_for('afficher_une_publication', id=pub.id_publication) }}" style="text-decoration: none; color: inherit;">
          <div class="publication-card">

            <!-- En-tÃªte avec image et titre -->
            <div style="display: flex; align-items: center;">
              <div class="publication-meta" style="display: flex; align-items: center; gap: 10px;">
                <!-- Image de profil ou image par dÃ©faut -->
                <img src="{{ url_for('static', filename=pub.photo_de_profil or 'images/photo de profil defaut.png') }}"
                     alt="Photo de profil"
                     width="50"
                     height="50"
                     style="border-radius: 50%; object-fit: cover;">
                <!-- Titre de la publication -->
                <h2 class="publication-title">{{ pub.p_titre }}</h2>
              </div>
            </div>

            <!-- MÃ©tadonnÃ©es : auteur + date + anonymat -->
            <div class="publication-meta">
              PostÃ© par <strong>{{ pub.username }}</strong>
              le {{ pub['date'].strftime('%d/%m/%Y %H:%M') }}
              {% if pub.statut == 'anonyme' %}
                <em>(anonyme)</em>
              {% endif %}
            </div>

            <!-- AperÃ§u du texte (tronquÃ© Ã  200 caractÃ¨res) -->
            <div class="publication-text">
              {{ pub.texte|truncate(200) }}
            </div>

            <!-- Pied : nombre de commentaires + rÃ©actions -->
            <div class="publication-footer">
              <div class="left-comments">
                {{ pub.nb_reponses }} Commentaire{{ 's' if pub.nb_reponses > 1 }}
              </div>

              <!-- RÃ©actions Ã  la publication -->
              <div class="right-reactions">
                {% if reactions[pub.id_publication] is defined %}
                  {% if reactions[pub.id_publication]['LIKE'] is defined %}
                    ğŸ‘ {{ reactions[pub.id_publication]['LIKE'] }}
                  {% endif %}
                  {% if reactions[pub.id_publication]['LOVE'] is defined %}
                    â¤ï¸ {{ reactions[pub.id_publication]['LOVE'] }}
                  {% endif %}
                  {% if reactions[pub.id_publication]['DISLIKE'] is defined %}
                    ğŸ‘ {{ reactions[pub.id_publication]['DISLIKE'] }}
                  {% endif %}
                  {% if reactions[pub.id_publication]['SAD'] is defined %}
                    ğŸ˜¢ {{ reactions[pub.id_publication]['SAD'] }}
                  {% endif %}
                  {% if reactions[pub.id_publication]['ANGRY'] is defined %}
                    ğŸ˜¡ {{ reactions[pub.id_publication]['ANGRY'] }}
                  {% endif %}
                {% endif %}
              </div>
            </div>
          </div>
        </a>
        {% endfor %}
      
      <!-- Si aucune publication nâ€™est prÃ©sente -->
      {% else %}
        <p class="no-data">Vous n'avez encore publiÃ© aucun message.</p>
      {% endif %}
    </div>
  </body>
</html>
